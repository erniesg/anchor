# Project Anchor - Initialization Guide

> **Mission**: "Structure for Sanity, Connection for the Heart"
> A caregiving coordination platform that transforms chaos into clarity for families managing eldercare with foreign domestic workers (FDW).

---

## üìã Table of Contents

1. [Project Overview](#project-overview)
2. [The Problem We're Solving](#the-problem-were-solving)
3. [MVP Definition](#mvp-definition)
4. [Tech Stack](#tech-stack)
5. [Architecture](#architecture)
6. [Getting Started](#getting-started)
7. [Development Workflow](#development-workflow)
8. [Project Structure](#project-structure)
9. [Key Principles](#key-principles)
10. [Success Metrics](#success-metrics)

---

## üéØ Project Overview

**What**: A Progressive Web App (PWA) that enables caregivers (FDW) to log daily care activities via simple mobile forms, while families access real-time dashboards with trend analysis and alerts.

**Who**:
- **Primary Users**: Adult children (35-55) in Singapore managing elderly parents remotely
- **Secondary Users**: Foreign domestic workers providing hands-on care
- **Care Recipients**: Elderly individuals with progressive conditions (starting with PSP - Progressive Supranuclear Palsy)

**When**: MVP launch target Q2 2025 (12 weeks from start)

**Where**: Singapore/Malaysia initially, Southeast Asia expansion

---

## üî• The Problem We're Solving

### The "Remote Manager" Burden

By 2026, 1 in 5 Singaporeans will be over 65. Families are scattered globally, and the default eldercare solution is a Foreign Domestic Worker managed remotely by an adult child who is:

- **Overwhelmed**: Random WhatsApp messages, panicked calls, no structured information
- **Anxious**: Constant low-grade fear of crisis calls during work meetings
- **Disconnected**: Operating as "remote administrator" instead of loving family member
- **Blind**: No visibility into weekday care ("weekday black hole")
- **Burnt Out**: Cognitive load at 200%, juggling career + kids + eldercare

### What We're Building

A **calm, structured system** that:
1. ‚úÖ Reduces cognitive load (offloads mental tracking work)
2. ‚úÖ Provides single source of truth (no more WhatsApp chaos)
3. ‚úÖ Enables proactive care (spot trends before crises)
4. ‚úÖ Extends home care duration (delays nursing home placement)
5. ‚úÖ Preserves human connection (less admin, more emotional presence)

---

## üéØ MVP Definition

### Core User Flows (Must-Have)

#### 1. Family Onboarding (5 minutes)
```
Sign up ‚Üí Add care recipient ‚Üí Create caregiver account (with PIN) ‚Üí Done
```

#### 2. Caregiver Daily Logging (<10 minutes)
```
PIN login ‚Üí Fill smart form ‚Üí Submit ‚Üí Family sees update
```
**Sections (MVP):**
- Morning routine (wake time, mood, shower)
- Medications (all time slots: before/after meals)
- Meals & nutrition (appetite, amount eaten, swallowing issues)
- Vital signs (BP, pulse, O2, blood sugar)
- Toileting (frequency, accidents, pain)
- Safety & incidents (falls, emergency button)

#### 3. Family Dashboard (At-a-glance peace of mind)
```
View today's summary ‚Üí Check trends (7 days) ‚Üí Receive alerts ‚Üí Export report
```
**Cards:**
- Medications (compliance tracking)
- Meals & Nutrition (appetite trends)
- Vital Signs (with sparkline graphs)
- Safety & Incidents (fall alerts)
- Last updated timestamp

### Out of Scope (Phase 2+)
- ‚ùå Full 16-section form (start with 6 core sections)
- ‚ùå Photo uploads
- ‚ùå Voice notes
- ‚ùå Multi-language (English only for MVP)
- ‚ùå In-app messaging
- ‚ùå WhatsApp integration
- ‚ùå Multiple caregivers per recipient
- ‚ùå Advanced AI pattern detection

---

## üõ† Tech Stack

### Frontend
- **Framework**: React 19 + TypeScript
- **Build Tool**: Vite
- **Routing**: TanStack Router (type-safe, file-based)
- **State/Data**: TanStack Query (caching, optimistic updates)
- **Forms**: React Hook Form + Zod validation
- **Styling**: Tailwind CSS v4
- **Charts**: Recharts
- **PWA**: Vite PWA plugin

### Backend (Cloudflare Workers)
- **API Framework**: Hono (fastest edge framework)
- **Database**: Cloudflare D1 (SQLite at edge)
- **ORM**: Drizzle ORM (edge-compatible, type-safe)
- **Auth**: Logto (self-hosted on Cloudflare Workers)
- **Storage**: Cloudflare R2 (for PDF reports)
- **Real-time**: Polling (30s) for MVP, Durable Objects Phase 2

### Infrastructure
- **Hosting**: Cloudflare Pages (frontend) + Workers (API)
- **CI/CD**: GitHub Actions ‚Üí Cloudflare
- **Monitoring**: Cloudflare Analytics + Sentry
- **Cost**: ~$5-10/month (Workers Paid plan)

### Development Tools
- **Monorepo**: pnpm workspaces
- **Testing**: Vitest (unit) + Playwright (e2e)
- **Linting**: ESLint + Prettier
- **Type Checking**: TypeScript strict mode
- **Git Hooks**: Husky + lint-staged

---

## üèó Architecture

### High-Level Flow
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               Cloudflare Global Network                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ Pages (PWA)  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Workers API  ‚îÇ‚îÄ‚îÄ‚ñ∂‚îÇ D1 (SQL)  ‚îÇ ‚îÇ
‚îÇ  ‚îÇ  React App   ‚îÇ    ‚îÇ Hono Router  ‚îÇ   ‚îÇ Drizzle   ‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ         ‚îÇ                    ‚îÇ                          ‚îÇ
‚îÇ         ‚îÇ                    ‚ñº                          ‚îÇ
‚îÇ         ‚îÇ            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îÇ
‚îÇ         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  R2 Storage  ‚îÇ                   ‚îÇ
‚îÇ                      ‚îÇ (PDF reports)‚îÇ                   ‚îÇ
‚îÇ                      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ  Users (Singapore/Malaysia Edge) ‚îÇ
        ‚îÇ  - Family (web/mobile browser)   ‚îÇ
        ‚îÇ  - Caregiver (PWA on phone)      ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Data Flow
```
Caregiver fills form ‚Üí Validation (Zod) ‚Üí POST /api/care-logs
                                                ‚Üì
                                    Hono middleware (auth check)
                                                ‚Üì
                                    Drizzle ORM ‚Üí D1 insert
                                                ‚Üì
                                    Return success + log ID
                                                ‚Üì
Family dashboard polls every 30s ‚Üí GET /api/dashboard/:recipientId
                                                ‚Üì
                                    Aggregate data from D1
                                                ‚Üì
                                    Return JSON (cached 30s)
```

### Security Architecture
```
Family Login:  Email/Password (Logto) ‚Üí JWT token ‚Üí Bearer auth
Caregiver:     PIN (6-digit) ‚Üí Custom auth ‚Üí Session token
API:           All routes require auth middleware
Database:      Row-level security via caregiver_id/family_id checks
```

---

## üöÄ Getting Started

### Prerequisites
```bash
node >= 20.x
pnpm >= 9.x
wrangler >= 3.x
git
```

### Initial Setup

#### 1. Clone & Install
```bash
cd /Users/erniesg/code/erniesg/anchor
pnpm install
```

#### 2. Cloudflare Setup
```bash
# Login to Cloudflare
wrangler login

# Create D1 database
wrangler d1 create anchor-db

# Create R2 bucket
wrangler r2 bucket create anchor-storage

# Copy wrangler output to .dev.vars
cp .dev.vars.example .dev.vars
# Add your D1 database ID and R2 bucket name
```

#### 3. Database Setup
```bash
# Generate migration files
pnpm db:generate

# Apply migrations (local)
pnpm db:migrate:local

# Apply migrations (production)
pnpm db:migrate:prod
```

#### 4. Environment Variables
Create `.dev.vars` in project root:
```bash
DATABASE_ID="your-d1-database-id"
R2_BUCKET="anchor-storage"
LOGTO_ENDPOINT="https://your-logto-domain.com"
LOGTO_APP_ID="your-app-id"
LOGTO_APP_SECRET="your-app-secret"
JWT_SECRET="generate-random-string-here"
```

#### 5. Start Development
```bash
# Start everything (parallel)
pnpm dev

# Opens:
# - Frontend: http://localhost:5173
# - API: http://localhost:8787
# - Drizzle Studio: http://localhost:4983
```

---

## üíª Development Workflow

### Test-Driven Development (TDD)

**Golden Rule**: **Write tests before code, commit regularly, push daily.**

#### TDD Cycle (Red-Green-Refactor)
```
1. üî¥ RED:    Write failing test
2. üü¢ GREEN:  Write minimal code to pass
3. üîµ REFACTOR: Improve code while keeping tests green
4. üìù COMMIT:  Commit after each completed cycle
```

#### Example Flow
```bash
# 1. Create test file
touch packages/database/src/schema.test.ts

# 2. Write failing test
# Test that care_logs table has correct columns

# 3. Run test (should fail)
pnpm test

# 4. Implement schema
# Add care_logs table definition

# 5. Run test (should pass)
pnpm test

# 6. Refactor if needed

# 7. Commit
git add .
git commit -m "test: add care_logs schema with validation"
```

### Commit Conventions

**Format**: `<type>(<scope>): <subject>`

**Types**:
- `feat`: New feature
- `fix`: Bug fix
- `test`: Adding/updating tests
- `refactor`: Code restructuring
- `docs`: Documentation changes
- `chore`: Tooling/config changes

**Examples**:
```bash
git commit -m "feat(api): add care log creation endpoint"
git commit -m "test(database): add schema validation tests"
git commit -m "fix(dashboard): resolve medication card state bug"
git commit -m "refactor(forms): extract medication form component"
```

### Git Workflow

#### Daily Practice
```bash
# Morning: Pull latest
git pull origin main

# During work: Commit frequently (every 30-60 min)
git add .
git commit -m "feat: add medication time picker"

# End of day: Push all commits
git push origin main

# Clean commit history (squash if >10 commits/day)
git rebase -i HEAD~10  # Optional, for cleanup
```

#### Feature Branches (Optional for MVP)
```bash
# Create feature branch
git checkout -b feat/family-dashboard

# Work on feature with regular commits
git commit -m "feat(dashboard): add medication card"
git commit -m "test(dashboard): add medication card tests"

# Merge back to main
git checkout main
git merge feat/family-dashboard
git push origin main
```

### Testing Strategy

#### Unit Tests (Vitest)
```bash
# Run all tests
pnpm test

# Watch mode (during development)
pnpm test:watch

# Coverage report
pnpm test:coverage

# Target: >90% coverage
```

**What to test:**
- Database schema validation
- API endpoint logic
- Form validation (Zod schemas)
- Utility functions
- React hooks

#### Integration Tests (Vitest)
```bash
pnpm test:integration
```

**What to test:**
- API ‚Üí Database flow
- Auth middleware
- Multi-table queries
- PDF generation

#### E2E Tests (Playwright)
```bash
pnpm test:e2e

# Headed mode (see browser)
pnpm test:e2e:headed

# Debug mode
pnpm test:e2e:debug
```

**What to test:**
- Family signup ‚Üí add recipient ‚Üí create caregiver
- Caregiver login ‚Üí fill form ‚Üí submit
- Family dashboard ‚Üí view summary ‚Üí export PDF
- Emergency button ‚Üí alert notification

### Code Quality Checks

Run before every commit:
```bash
# Type checking
pnpm typecheck

# Linting
pnpm lint

# Formatting
pnpm format

# All checks
pnpm validate  # Runs all of the above + tests
```

### Database Migrations

```bash
# 1. Modify schema in packages/database/src/schema.ts

# 2. Generate migration
pnpm db:generate

# 3. Review generated SQL in drizzle/migrations/

# 4. Apply to local D1
pnpm db:migrate:local

# 5. Test locally

# 6. Apply to production D1
pnpm db:migrate:prod

# 7. Commit migration files
git add drizzle/migrations/
git commit -m "chore(db): add fall_risk_assessment table"
```

---

## üìÅ Project Structure

```
anchor/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/                          # Frontend PWA
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ manifest.json         # PWA manifest
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/               # TanStack Router
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.tsx         # Landing page
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ signup.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ family/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ recipient/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ $id.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ caregiver/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ login.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ medication-card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vitals-card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chart.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ medication-form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vitals-form.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scale-selector.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/               # Reusable UI
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api-client.ts     # TanStack Query setup
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ use-care-log.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ use-dashboard.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vite.config.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ api/                          # Cloudflare Workers API
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ index.ts              # Hono app entry
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts           # POST /auth/login, /auth/signup
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ care-logs.ts      # CRUD /care-logs
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.ts      # GET /dashboard/:recipientId
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ family.ts         # CRUD /family
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ caregiver.ts      # CRUD /caregiver
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts           # JWT verification
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cors.ts
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard.service.ts
‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ care-log.service.ts
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.service.ts
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ lib/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ db.ts             # Drizzle client
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ utils.ts
‚îÇ       ‚îú‚îÄ‚îÄ wrangler.toml
‚îÇ       ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ database/                     # Shared database schema
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ drizzle/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/           # Auto-generated SQL
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema.ts             # Drizzle tables
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts             # DB client factory
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schema.test.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ drizzle.config.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ shared/                       # Shared types & validators
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ care-log.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validators/           # Zod schemas
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ care-log.schema.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.schema.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ config/                       # Shared configs
‚îÇ       ‚îú‚îÄ‚îÄ eslint.config.js
‚îÇ       ‚îú‚îÄ‚îÄ tsconfig.json
‚îÇ       ‚îî‚îÄ‚îÄ tailwind.config.js
‚îÇ
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ e2e/                          # Playwright tests
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ family-onboarding.spec.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ caregiver-logging.spec.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard.spec.ts
‚îÇ   ‚îî‚îÄ‚îÄ fixtures/                     # Test data
‚îÇ       ‚îî‚îÄ‚îÄ seed-data.ts
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ INIT.md                       # This file
‚îÇ   ‚îú‚îÄ‚îÄ TDD_CHECKLIST.md              # Phased development checklist
‚îÇ   ‚îú‚îÄ‚îÄ API.md                        # API documentation
‚îÇ   ‚îî‚îÄ‚îÄ DEPLOYMENT.md                 # Deployment guide
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ seed-db.ts                    # Seed test data
‚îÇ   ‚îî‚îÄ‚îÄ generate-migration.ts
‚îÇ
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îú‚îÄ‚îÄ test.yml                  # Run tests on PR
‚îÇ       ‚îî‚îÄ‚îÄ deploy.yml                # Deploy to Cloudflare
‚îÇ
‚îú‚îÄ‚îÄ .dev.vars.example
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ pnpm-workspace.yaml
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

---

## üéØ Key Principles

### 1. Test-Driven Development (TDD)
- ‚úÖ Write tests BEFORE implementation
- ‚úÖ Maintain >90% test coverage
- ‚úÖ Run tests before every commit
- ‚úÖ Never skip tests for "speed"

### 2. Commit Frequently, Push Daily
- ‚úÖ Commit every 30-60 minutes of meaningful work
- ‚úÖ Push all commits at end of day
- ‚úÖ Use semantic commit messages
- ‚úÖ Keep commits atomic (one logical change per commit)

### 3. Type Safety Everywhere
- ‚úÖ Use TypeScript strict mode
- ‚úÖ No `any` types (use `unknown` if needed)
- ‚úÖ Validate all inputs with Zod
- ‚úÖ Share types across frontend/backend

### 4. Mobile-First, Offline-First
- ‚úÖ Design for mobile screens first
- ‚úÖ PWA with service worker caching
- ‚úÖ Optimistic UI updates
- ‚úÖ Handle offline gracefully

### 5. Calm & Clarity Design
- ‚úÖ Clean, uncluttered interfaces
- ‚úÖ Large touch targets (48px minimum)
- ‚úÖ High contrast for readability
- ‚úÖ Consistent spacing/typography

### 6. Security by Default
- ‚úÖ All routes require authentication
- ‚úÖ Row-level security checks
- ‚úÖ Input validation on client + server
- ‚úÖ Rate limiting on sensitive endpoints

### 7. Performance Budget
- ‚úÖ First Contentful Paint < 1.5s
- ‚úÖ Time to Interactive < 3s
- ‚úÖ Lighthouse score > 90
- ‚úÖ Bundle size < 200KB (gzipped)

---

## üìä Success Metrics

### MVP Success Criteria (Week 12)

#### Technical Metrics
- [ ] Test coverage > 90%
- [ ] Zero critical bugs in production
- [ ] API response time < 500ms (p95)
- [ ] Dashboard load time < 2s
- [ ] PWA score > 90 (Lighthouse)
- [ ] Uptime > 99.5%

#### User Metrics (3 Pilot Families)
- [ ] Family signup ‚Üí first log < 24 hours
- [ ] Caregiver form completion time < 10 minutes
- [ ] Family checks dashboard > 2x/day
- [ ] Medication compliance tracking > 90%
- [ ] Emergency button response time < 30 seconds
- [ ] User satisfaction (NPS) > 50

#### Product Metrics
- [ ] All 6 core form sections working
- [ ] 7-day trend analysis for meds + vitals
- [ ] PDF report generation functional
- [ ] Alert system operational (falls, missed meds)
- [ ] Mobile responsive on iOS + Android
- [ ] Offline mode working (form auto-save)

---

## üìö Additional Resources

### Documentation
- **API Docs**: See `docs/API.md`
- **Deployment Guide**: See `docs/DEPLOYMENT.md`
- **TDD Checklist**: See `docs/TDD_CHECKLIST.md`

### External Docs
- [Cloudflare Workers](https://developers.cloudflare.com/workers/)
- [Hono Framework](https://hono.dev/)
- [Drizzle ORM](https://orm.drizzle.team/)
- [TanStack Router](https://tanstack.com/router)
- [TanStack Query](https://tanstack.com/query)

### Design References
- **Figma**: (Add link when created)
- **Existing HTML mockups**: `/assets/ui/*.html`
- **Care template PDF**: `/assets/Daily Care Report Template.pdf`

---

## üö¶ Next Steps

1. ‚úÖ Read this document completely
2. ‚úÖ Review `TDD_CHECKLIST.md` for phased development plan
3. ‚¨ú Set up development environment (follow "Getting Started")
4. ‚¨ú Run initial project scaffold script
5. ‚¨ú Complete Phase 1, Week 1 checklist
6. ‚¨ú Daily: Commit regularly, push at EOD
7. ‚¨ú Weekly: Review progress against checklist

---

## üìû Support

**Questions?**
- Check existing documentation first
- Review code comments and tests
- Ask in project Slack/Discord (if applicable)

**Found a bug?**
- Check if test exists for the bug
- Write failing test first
- Fix bug
- Commit with `fix:` prefix

**Want to add a feature?**
- Check if it's in MVP scope
- If yes: Add to TDD checklist, write test
- If no: Add to Phase 2+ backlog

---

## üìù Version History

- **v0.1.0** (2025-09-30): Initial project setup and documentation
- **v1.0.0** (Target: Q2 2025): MVP launch

---

**Remember**: "Structure for Sanity, Connection for the Heart"

Every line of code you write is helping a family stay connected and a caregiver provide better care. Build with empathy, test with rigor, commit with discipline.

Let's build something that matters. üöÄ